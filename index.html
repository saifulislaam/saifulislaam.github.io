<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Hand Gesture Brightness Control</title>
<style>
    body {
        margin: 0;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        background: #111;
        color: white;
        font-family: Arial, sans-serif;
        transition: filter 0.1s ease;
    }
    video {
        position: fixed;
        top: 0; left: 0;
        width: 100vw;
        height: 100vh;
        object-fit: cover;
        transform: scaleX(-1);
        opacity: 0.3;
    }
    canvas {
        position: fixed;
        top: 0; left: 0;
        width: 100vw;
        height: 100vh;
        pointer-events: none;
    }
</style>
</head>
<body>
<h1>Move your hand up/down to change brightness</h1>
<video id="video" autoplay playsinline></video>
<canvas id="output"></canvas>

<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.min.js"></script>

<script>
const video = document.getElementById('video');
const canvas = document.getElementById('output');
const ctx = canvas.getContext('2d');

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// MediaPipe Hands Setup
const hands = new Hands({
  locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`
});

hands.setOptions({
  maxNumHands: 1,
  modelComplexity: 1,
  minDetectionConfidence: 0.7,
  minTrackingConfidence: 0.7
});

hands.onResults(onResults);

function onResults(results) {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Draw landmarks
  if (results.multiHandLandmarks && results.multiHandLandmarks.length > 0) {
    for (const landmarks of results.multiHandLandmarks) {
      drawConnectors(ctx, landmarks, HAND_CONNECTIONS, {color: '#00ff00', lineWidth: 3});
      drawLandmarks(ctx, landmarks, {color: '#00ff00', lineWidth: 2});

      // Index finger tip is landmark[8]
      const indexFinger = landmarks[8];
      const yPos = indexFinger.y; // 0 (top) to 1 (bottom)
      const brightness = 0.5 + (0.5 - yPos) * 1.5; // Map to brightness range
      document.body.style.filter = `brightness(${Math.max(0.1, Math.min(2, brightness))})`;
    }
  }
}

// Camera input
const camera = new Camera(video, {
  onFrame: async () => {
    await hands.send({image: video});
  },
  width: 640,
  height: 480
});
camera.start();
</script>
</body>
</html>